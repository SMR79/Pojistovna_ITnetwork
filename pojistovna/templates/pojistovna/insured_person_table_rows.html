{% for one_insured_person in page_obj %}
<tr>
    <td>{{ one_insured_person.id }}</td>
    <td>{{ one_insured_person.name }}</td>
    <td>{{ one_insured_person.surname }}</td>
    <td>{{ one_insured_person.email }}</td>
    <td>{{ one_insured_person.telephone_number }}</td>
    <td>{{ one_insured_person.insurance_count }}</td>
    <td>
        {% if one_insured_person.user %}
            Dokončena
        {% else %}
            Nedokončena
        {% endif %}
    </td>
    <td>
        {% if user.is_superuser or user.is_staff %}
            {% if not one_insured_person.user %}
                <button type="button" class="btn btn-outline-primary btn-sm" onclick="window.location.href='{% url 'pojistovna:register' one_insured_person.id %}'">Dokončit registraci</button>
            {% endif %}
            
            <button type="button" class="btn btn-info btn-sm" onclick="window.location.href='{% url 'pojistovna:insured_person_detail' one_insured_person.id %}'">Detail</button>
            

            <button type="button" class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal{{ one_insured_person.id }}">
                Smazat
            </button>

            <!-- Modal -->
            <div class="modal fade" id="deleteModal{{ one_insured_person.id }}" tabindex="-1" aria-labelledby="deleteModalLabel{{ one_insured_person.id }}" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteModalLabel{{ one_insured_person.id }}">Potvrzení smazání</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zavřít"></button>
                        </div>
                        <div class="modal-body">
                            Opravdu chcete smazat pojištěnce <strong>{{ one_insured_person.name }} {{ one_insured_person.surname }}</strong>?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zrušit</button>
                            <form method="post" action="{% url 'pojistovna:insured_person_delete' one_insured_person.id %}">
                                {% csrf_token %}
                            <button type="submit" class="btn btn-danger">Smazat</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>            
        {% endif %}
    </td>
</tr>
{% empty %}
<tr><td colspan="8">Žádní pojištěnci nejsou evidováni.</td></tr>
{% endfor %}

{% if page_obj.has_other_pages %}
<tr>
    <td colspan="8">
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center mb-0">
                {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?name={{ name }}&surname={{ surname }}&page=1" aria-label="First">« První</a>                
                </li>
                <li class="page-item">
                    <a class="page-link" href="?name={{ name }}&surname={{ surname }}&page={{ page_obj.previous_page_number }}" aria-label="Previous">Předchozí</a>
                </li>
                {% else %}
                <li class="page-item disabled"><span class="page-link">« První</span></li>
                <li class="page-item disabled"><span class="page-link">Předchozí</span></li>
                {% endif %}

                {% for num in page_obj.paginator.page_range %}
                    {% if num == page_obj.number %}
                    <li class="page-item active" aria-current="page">
                        <span class="page-link">{{ num }}</span>
                    </li>
                    {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                    <li class="page-item"><a class="page-link" href="?q={{ query }}&page={{ num }}">{{ num }}</a></li>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?name={{ name }}&surname={{ surname }}&page={{ page_obj.next_page_number }}" aria-label="Next">Další</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?name={{ name }}&surname={{ surname }}&page={{ page_obj.paginator.num_pages }}" aria-label="Last">Poslední »</a>
                </li>
                {% else %}
                <li class="page-item disabled"><span class="page-link">Další</span></li>
                <li class="page-item disabled"><span class="page-link">Poslední »</span></li>
                {% endif %}
            </ul>
        </nav>
    </td>
</tr>
{% endif %}